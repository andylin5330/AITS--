# 前端构建阶段
FROM node:18-alpine AS builder

WORKDIR /app
# 复制 package 配置并安装依赖
COPY aits_frontend/package*.json ./
RUN npm install

# 复制前端源码并执行打包
COPY aits_frontend/ .
RUN npm run build

# Nginx 生产环境服务阶段
FROM nginx:alpine

# 将构建产出复制到 Nginx 默认静态文件目录
COPY --from=builder /app/dist /usr/share/nginx/html

# 可选：如果项目中用到 Vue Router 的 history 模式，需要覆盖 Nginx 配置
# 可以在后期按需创建并拷贝 ./nginx.conf 到 /etc/nginx/conf.d/default.conf

EXPOSE 80
CMD ["nginx", "-g", "daemon off;"]
